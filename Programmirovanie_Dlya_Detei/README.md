## Задание 3.49


В каждом документе *УчебныйДень* удалите последний урок. В каждом учебном дне должно остаться по 5 уроков. 
Для выполнения этого задания создайте новую процедуру в общем модуле *Серверный*. Перед запуском и проверкой своей программы запишите где-нибудь, какой урок должен оказаться последним в каждый из дней. Чтобы у вас была возможность проверить правильность работы.


```bsl
// Общие модули - Серверный

Процедура Удалить5Урок() Экспорт 
	Выборка = Документы.УчебныйДень.Выбрать();
	Пока Выборка.Следующий() Цикл
		ДокументОбъект = Выборка.ПолучитьОбъект();
		ДокументТабличнаяЧасть = ДокументОбъект.Уроки;
		Если ДокументТабличнаяЧасть.Количество() = 6 Тогда
			Сообщить(
			"Учебный день (Документ) № " + ДокументОбъект.Номер + "
			|от: " + Формат(ДокументОбъект.Дата, "ДЛФ=DD") + " имеет 6 уроков " + "
			|6-ой урок: " + """" + ДокументТабличнаяЧасть.Получить(5).Предмет + """" + " - будет удален."
			);			
			ДокументТабличнаяЧасть.Удалить(5);
			ДокументОбъект.Записать();
		КонецЕсли;
	КонецЦикла;
КонецПроцедуры
```

```bsl
// Модуль управляемого приложения

Процедура ПриНачалеРаботыСистемы()
	Серверный.Удалить5Урок();	
КонецПроцедуры
```

![alt text](image.png)



Задание 4.1
Измените алгоритм создания новых учебных дней так, чтобы они копировались не с текущей недели, а с той недели, день которой выделен в списке. Для выполнения задания создайте новую информационную базу и загрузите в неё демонстрационную базу "05 КопированиеУчебныхДней.dt". Как её подключить, написано в разделе А.1 "Как подключить демонстрационную базу" на странице 543.


```bsl
&НаСервере
Процедура ЗаполнитьРасписаниеСВыделенногоДняВСписке(ПараметрКоманды);
	
	ВыделенныйДокумент = Документы.УчебныйДень.НайтиПоНомеру(
	Серверный.ПолучитьНомер(
	ПараметрКоманды.Дата
	)
	);
	НачалоУчебнойНедели = НачалоНедели(ВыделенныйДокумент.Дата);
	
	Для Счетчик = 0 По 4 Цикл
		
		ДатаУчебногоДня = НачалоУчебнойНедели + (Счетчик * 86400);
		
		ДокументДеньУчебнойНедели = Документы.УчебныйДень.НайтиПоНомеру(
		Серверный.ПолучитьНомер(
		ДатаУчебногоДня		
		)
		);
		
		Если ДокументДеньУчебнойНедели.Пустая() Тогда
			Сообщить(
			"На " + 
			Формат(ДатаУчебногоДня, "ДФ='д ММММ гггг, дддд'") + 
			" - НЕТ учебного дня для копирования."
			);
		Иначе
			Сообщить(
			"На " + 
			Формат(ДатаУчебногоДня, "ДФ='д ММММ гггг, дддд'") + 
			" - ЕСТЬ учебный день для копирования."
			);
			
			НовыйДокументУчебногоДня = Документы.УчебныйДень.СоздатьДокумент();
			НовыйДокументУчебногоДня.Дата = ДокументДеньУчебнойНедели.Дата + (86400 * 7);
			
			Для Каждого СтрокаТабличнойЧасти Из ДокументДеньУчебнойНедели.Уроки Цикл
				НоваяСтрока = НовыйДокументУчебногоДня.Уроки.Добавить();
				НоваяСтрока.Предмет = СтрокаТабличнойЧасти.Предмет;
			КонецЦикла;	
							
			НовыйДокументУчебногоДня.Записать();
			
		КонецЕсли;
		
	КонецЦикла;
	
	
КонецПроцедуры

```
